<div class="p-4 min-h-screen bg-gradient-to-b from-purple-50 to-purple-100">

  <!-- ðŸ§ Username prompt if cookie not set -->
  <div *ngIf="showNamePrompt"
    class="fixed inset-0 bg-black/40 backdrop-blur-sm flex justify-center items-center z-50 animate-fadeIn">
    <div class="bg-white rounded-2xl p-6 w-11/12 max-w-sm shadow-2xl border border-purple-200 animate-slideUp">
      <h2 class="text-xl font-bold mb-4 text-purple-700 text-center">Enter Your Name</h2>
      <input type="text" [(ngModel)]="usernameInput" placeholder="Enter your name"
        class="border border-purple-300 focus:ring-2 focus:ring-purple-500 outline-none p-2 rounded-lg w-full mb-4">
      <div class="flex justify-end">
        <button class="bg-purple-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-purple-700 transition"
          (click)="setUsername(usernameInput)">Submit</button>
      </div>
    </div>
  </div>

  <!-- ðŸ’œ Header: Title, selected category, add button -->
  <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-3">
    <h2 class="text-3xl font-extrabold text-purple-700">Shayari Board</h2>

    <div class="flex items-center flex-wrap gap-4">
      <span *ngIf="selectedCategory !== 'All'" class="text-purple-600 font-semibold bg-purple-100 px-3 py-1 rounded-lg">
        Category: {{ selectedCategory }}
      </span>
      <button
        class="bg-purple-600 text-white font-semibold px-5 py-2 rounded-lg hover:bg-purple-700 active:bg-purple-800 transition-colors shadow-md"
        (click)="toggleAddPopup()">+ Add Shayari</button>
    </div>
  </div>

  <!-- ðŸ·ï¸ Category filter -->
  <div class="mb-6 max-w-xs">
    <select [(ngModel)]="selectedCategory" (change)="filterCategory(selectedCategory)"
      class="border border-purple-300 focus:ring-2 focus:ring-purple-500 outline-none p-2 rounded-lg w-full">
      <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
    </select>
  </div>

  <!-- ðŸ“ Shayari list grouped by category -->
  <ng-container *ngFor="let category of categories">
    <div *ngIf="groupedShayaris[category]" class="mb-8 animate-fadeIn">
      <h3 class="text-xl font-bold text-purple-700 mb-3 border-b-2 border-purple-300 pb-1">{{ category }}</h3>

      <div *ngFor="let shayari of groupedShayaris[category]"
        class="bg-white shadow-md rounded-xl p-4 mb-3 border border-purple-100 hover:shadow-lg transition">
        <p class="text-gray-800 mb-2">{{ shayari.content }}</p>
        <small class="block text-right text-gray-500 text-xs">
          By: {{ shayari.createdBy || 'Anonymous' }} <br>
          <span class="text-gray-400">{{ shayari.createdAt | date:'short' }}</span>
        </small>
      </div>
    </div>
  </ng-container>

  <!-- ðŸ’¬ Add Shayari Modal -->
  <div *ngIf="showAddPopup"
    class="fixed inset-0 bg-black/30 backdrop-blur-sm flex justify-center items-center z-50 animate-fadeIn">
    <div class="bg-white rounded-2xl p-6 w-11/12 max-w-md relative shadow-2xl border border-purple-200 animate-slideUp">

      <h2 class="text-2xl font-bold mb-5 text-purple-700 text-center">Add New Shayari</h2>

      <!-- Reactive Form -->
      <form [formGroup]="addForm">

        <!-- Category -->
        <select formControlName="category"
          class="border border-purple-300 focus:ring-2 focus:ring-purple-500 outline-none p-2 rounded-lg w-full mb-4">
          <option value="" disabled>Select Category</option>
          <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
        </select>

        <!-- Content -->
        <textarea formControlName="content"
          class="border border-purple-300 focus:ring-2 focus:ring-purple-500 outline-none p-3 rounded-lg w-full mb-4 h-32 resize-none"
          placeholder="Write your shayari here..."></textarea>

        <!-- Buttons -->
        <div class="flex justify-end gap-3">
          <button type="button"
            class="bg-gray-300 text-gray-800 font-semibold px-4 py-2 rounded-lg hover:bg-gray-400 transition"
            (click)="toggleAddPopup()">Cancel</button>

          <!-- âœ… Fixed Add button -->
          <button type="button"
            class="!bg-purple-600 text-white font-semibold px-4 py-2 rounded-lg shadow-md focus:outline-none hover:!bg-purple-700 active:!bg-purple-800 transition"
            (click)="addShayari()">
            Add
          </button>




        </div>
      </form>
    </div>
  </div>

</div>

<!-- ðŸŒŸ Animations -->
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
    }

    to {
      opacity: 1;
    }
  }

  @keyframes slideUp {
    from {
      transform: translateY(20px);
      opacity: 0;
    }

    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.3s ease-in-out;
  }

  .animate-slideUp {
    animation: slideUp 0.35s ease-in-out;
  }
</style>